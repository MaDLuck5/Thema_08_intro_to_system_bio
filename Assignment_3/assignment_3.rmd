---
title: Assignment 3
output: html_notebook
---
```{r}

data <- read.csv("Data/MPL.csv", na.strings = "NA")
median_MPL_01 <- median(data$MPL_conc[data$dose==0.1], na.rm=T)
median_MPL_01
```
```{r}
library("deSolve")

D <- (20 * 1000)/374.471
parameters <- c(Ks_rm = 2.90, ic50_rm = 26.2, Kon = 0.00329, Kt = 0.63, Kre = 0.57, Rf = 0.49, Kd_R = 0.0572, Kd_Rm = 0.612, Ks_r = 3.22, D = D)
state <- c(Rmo = 4.74, Ro = 267, DR = 0, DRN = 0)
times <- seq(0, 48,  by = 1)

Grd_model <- function(t, y, parms){
  with(as.list(c(parms, y)),{
    Rmo.delta <- Ks_rm * (1-(DRN / (ic50_rm + DRN)))- Kd_Rm * Rmo
    R.delta <- Ks_r *  Rmo + Rf * Kre * DRN - Kon * D * Ro - Kd_R * Ro
    DR.delta <- Kon * D * Ro - Kt * DR
    DRN.delta <- Kt * DR - Kre * DRN

        return(list(c(Rmo.delta, R.delta, DR.delta, DRN.delta)))
       })
}

out <- ode(times = times, y = state,   parms = parameters, func = Grd_model, method = "euler")

plot(out)
```
